define(['jquery'],function($){'use strict';const gtmJsComponent=function(gtmData){if(typeof dataLayer!=='undefined'){const productsListData={event:"view_item_list",ecommerce:{items:gtmData.gtmListData}};dataLayer.push(productsListData);$('.product-item .product-item-info a').off('click').on('click',function(e){e.stopPropagation();e.preventDefault();let goTo=$(this).attr('href');if(typeof $(this).closest('.product-item').attr('data-layer-collected')!=='undefined'){if($(this).closest('.product-item').attr('data-layer-collected').length){const productData=JSON.parse($(this).closest('.product-item').attr('data-layer-collected'));const productGtmData={event:"select_item",ecommerce:{items:[productData]}};dataLayer.push(productGtmData);let productLists=JSON.parse(localStorage.getItem("productLists"));let listToAdd={"list":productData.item_list_name,"productId":productData.item_id,"productName":productData.item_name,"productPrice":productData.price,"itemCategory1":productData.item_category,"itemCategory2":productData.item_category2,"itemCategory3":productData.item_category3,"itemVariant":productData.item_variant};if(!productLists){localStorage.setItem("productLists","["+JSON.stringify(listToAdd)+"]");}else{let indexToChange=0,isProductInObject;productLists.find((o,i)=>{if(o.productId===productData.item_id){isProductInObject=true;indexToChange=i;return true;}});if(!isProductInObject){productLists[productLists.length]=listToAdd;}else{productLists[indexToChange]={"list":productData.item_list_name,"productId":productData.item_id,"productName":productData.item_name};}
localStorage.setItem("productLists",JSON.stringify(productLists));}}}
setTimeout(function(){window.location.href=goTo;},1);});}}
return gtmJsComponent;});