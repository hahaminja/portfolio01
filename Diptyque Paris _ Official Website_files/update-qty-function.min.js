define(['jquery','Magento_Ui/js/view/messages'],function($,messages){'use strict';window.testMessages=messages;var update={};update.execute=function(){$('input.qty').data('changed-during-reload',false).change(function(event){event.preventDefault();var form=$('#form-validate');if(!form.data('reloading')){$('#form-validate').data('reloading',false).submit(function(){return false;});form.data('reloading',true);$(this).data('changed-during-reload',false);var name=$(this).attr('name');var self=this;var matched=name.match(/^cart\[(\d+)\]\[qty\]$/);if(matched.length==2){$.ajax({type:"POST",showLoader:false,url:window.qtyUpdateUrl,data:{id:matched[1],qty:$(this).val()},dataType:"json",success:function(data,textStatus,jqXHR){if(!$(self).data('changed-during-reload')){if(data.qty){$(self).val(data.qty);}
if(data.row){$('#price-row-'+matched[1]).html(data.row);}
if(data.unit){$('#price-unit-'+matched[1]).html(data.unit);}
if(data.total){$('#cart-totals .totals.sub .amount span').html(data.total);$('#cart-totals .grand.totals.incl .amount strong').html(data.total);}}},complete:function(jqXHR,textStatus){form.data('reloading',false);if($(self).data('changed-during-reload')){$(self).change();}}});}}
else{$(this).data('changed-during-reload',true);}
return false;});};return update;});