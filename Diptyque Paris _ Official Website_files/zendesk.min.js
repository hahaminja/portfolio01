define(['jquery','domReady!'],function(params){'use strict';return function(params){var loadScript=function(key){var node=document.createElement('script');node.id="ze-snippet";node.src='//static.zdassets.com/ekr/snippet.js?key='+key;node.type='text/javascript';node.async=true;node.charset='utf-8';document.getElementsByTagName('body')[0].appendChild(node);}
var configureWidgetDept=function(deptNum,deptName,tag){console.log(deptName);$zopim(function(){$zopim.livechat.setOnConnected(function(){var depts=$zopim.livechat.departments.getAllDepartments();console.log('Depts');console.log(depts);var hasDeptOnline=0;console.log('Dept Number',deptNum);console.log('Dept Name',deptName);depts.forEach(function(el,index,array){console.log(el);if(el.id==deptNum&&el.status=="online"){console.log('Matched online',el.id)
zE('webWidget','updateSettings',{webWidget:{chat:{departments:{enabled:[deptNum],select:deptNum}}}});zE('webWidget','chat:addTags',tag);hasDeptOnline++;}});if(hasDeptOnline<1){console.log('no department');zE('webWidget','updateSettings',{webWidget:{chat:{suppress:true},}});if($zopim.livechat.isChatting()==true){$zopim.livechat.clearAll();}}
zE('webWidget','updateSettings',{webWidget:{chat:{departments:{enabled:[],}}}});});});}
if(params.storeKey){loadScript(params.storeKey);}
var jpInterval=setInterval(function(i){if(window.$zopim===undefined||window.$zopim.livechat===undefined||window.$zopim.livechat.departments===undefined){return;}
if(params.storeKey&&params.depCode&&params.brandCode){configureWidgetDept(params.depCode,'',params.brandCode);}
clearInterval(jpInterval);},100);window.zESettings={webWidget:{contactOptions:{enabled:true,}}};};});